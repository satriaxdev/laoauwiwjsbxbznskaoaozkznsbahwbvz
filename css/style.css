*{box-sizing:border-box;transition:all .5s ease;}
body{
  margin:0;
  font-family:"Poppins",system-ui;
  background:#0f172a;
  color:#e2e8f0;
  display:flex;flex-direction:column;
  height:100vh;overflow:hidden;position:relative;
}
#transitionLayer{
  position:absolute;top:0;left:0;right:0;bottom:0;
  background:#000;opacity:0;pointer-events:none;
  transition:opacity .8s ease;z-index:9990;
}
#particleCanvas{
  position:absolute;top:0;left:0;width:100%;height:100%;
  pointer-events:none;z-index:1;
}
header{
  background:#1e293b;padding:10px 16px;border-bottom:1px solid #475569;
  display:flex;align-items:center;justify-content:space-between;
  box-shadow:0 0 15px rgba(30,41,59,0.5);position:relative;z-index:9999;
}
header img{
  width:42px;height:42px;border-radius:50%;object-fit:cover;
  border:2px solid #94a3b8;
}
header h1{font-size:16px;margin:0;color:#f8fafc}
#menuBtn{font-size:26px;cursor:pointer;color:#94a3b8;user-select:none;}
#menuPopup{
  position:absolute;top:60px;right:16px;background:#1e293b;
  border:1px solid #94a3b8;border-radius:12px;padding:10px;
  display:none;flex-direction:column;gap:10px;box-shadow:0 0 15px #000;
  z-index:99999;
  min-width:200px;
}
.option{padding:8px 12px;border-radius:8px;cursor:pointer;color:#e2e8f0;}
.option:hover{background:#94a3b8;color:#1e293b;}
.menu-divider{height:1px;background:#94a3b8;margin:5px 0;opacity:0.5;}

.chat-box{
  flex:1;
  overflow-y:auto;
  padding:16px;
  padding-bottom:120px;
  display:flex;
  flex-direction:column;
  gap:12px;
  scroll-behavior:smooth;
  z-index:2;
}
.msg{display:flex;gap:8px;max-width:85%;opacity:0;transform:translateY(15px);
  animation:slideUp .4s ease forwards;}
@keyframes slideUp{to{opacity:1;transform:none}}
.msg.bot{align-self:flex-start}
.msg.user{align-self:flex-end;flex-direction:row-reverse}
.bubble{padding:10px 14px;border-radius:14px;line-height:1.5;word-wrap:break-word;}
.avatar{width:34px;height:34px;border-radius:50%;object-fit:cover;border:2px solid #94a3b8;flex-shrink:0;}

.typingAnim{display:inline-block;animation:blink 1s infinite;}
@keyframes blink{0%,100%{opacity:1}50%{opacity:0.3}}

.input-area{
  position:fixed;bottom:0;left:0;right:0;
  background:#1e293b;padding:10px;
  display:flex;align-items:center;gap:10px;
  border-top:1px solid #475569;
  flex-wrap:wrap;z-index:9999;
  box-sizing:border-box;
  padding-bottom:max(10px, env(safe-area-inset-bottom));
}
#previewBox{
  display:none;flex-direction:column;gap:8px;width:100%;
  background:#334155;border:1px solid #94a3b8;
  border-radius:10px;padding:10px;margin-bottom:8px;
}
#previewBox img{max-width:120px;border-radius:8px;border:1px solid #94a3b8;}
#previewTop{display:flex;align-items:center;justify-content:space-between;
  font-size:14px;color:#f8fafc;}
#removeBtn{background:#475569;color:#f8fafc;border:none;border-radius:6px;
  padding:4px 8px;cursor:pointer;font-size:13px;}
#removeBtn:hover{background:#64748b;}
#userInput{
  flex:1;background:transparent;border:2px solid #94a3b8;
  border-radius:999px;padding:10px 14px;color:#f8fafc;font-size:14px;
  outline:none;
}
button,.upload-label{
  width:42px;height:42px;border-radius:50%;
  display:flex;align-items:center;justify-content:center;
  cursor:pointer;border:none;transition:.3s;
}
.upload-label{background:#475569;color:#f8fafc;}
button{background:#94a3b8;color:#1e293b;font-size:18px;}
button:hover,.upload-label:hover{transform:scale(1.05);}
#status{font-size:13px;color:#cbd5e1;}

/* Modal Styles */
.modal{
  position:fixed;top:0;left:0;right:0;bottom:0;
  background:rgba(0,0,0,0.8);display:flex;align-items:center;
  justify-content:center;z-index:100000;opacity:0;pointer-events:none;
  transition:opacity 0.3s ease;
}
.modal.active{opacity:1;pointer-events:all;}
.modal-content{
  background:#1e293b;border:2px solid #94a3b8;border-radius:15px;
  padding:20px;max-width:90%;width:400px;max-height:80vh;
  overflow-y:auto;transform:scale(0.9);transition:transform 0.3s ease;
}
.modal.active .modal-content{transform:scale(1);}
.modal-header{display:flex;justify-content:space-between;align-items:center;
  margin-bottom:15px;border-bottom:1px solid #94a3b8;padding-bottom:10px;}
.modal-title{font-size:18px;color:#f8fafc;margin:0;}
.modal-close{background:none;border:none;color:#94a3b8;font-size:24px;
  cursor:pointer;padding:0;width:30px;height:30px;display:flex;
  align-items:center;justify-content:center;}
.modal-body{display:flex;flex-direction:column;gap:15px;}
.form-group{display:flex;flex-direction:column;gap:5px;}
.form-label{color:#f8fafc;font-size:14px;}
.form-input,.form-textarea{
  background:#334155;border:1px solid #94a3b8;border-radius:8px;
  padding:10px;color:#f8fafc;font-size:14px;font-family:inherit;
}
.form-textarea{resize:vertical;min-height:100px;}
.form-input:focus,.form-textarea:focus{outline:none;border-color:#cbd5e1;}
.btn-group{display:flex;gap:10px;justify-content:flex-end;margin-top:10px;}
.btn{background:#94a3b8;color:#1e293b;border:none;border-radius:8px;
  padding:8px 16px;cursor:pointer;font-size:14px;transition:0.3s;}
.btn:hover{background:#cbd5e1;}
.btn-secondary{background:#475569;}
.btn-secondary:hover{background:#64748b;}

/* Stats Styles */
.stats-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px;}
.stat-card{background:#334155;border:1px solid #94a3b8;border-radius:10px;
  padding:15px;text-align:center;}
.stat-number{font-size:24px;color:#94a3b8;font-weight:bold;}
.stat-label{font-size:12px;color:#f8fafc;margin-top:5px;}

/* History Styles */
.history-list{max-height:300px;overflow-y:auto;border:1px solid #94a3b8;
  border-radius:8px;background:#334155;}
.history-item{padding:10px;border-bottom:1px solid #475569;cursor:pointer;}
.history-item:last-child{border-bottom:none;}
.history-item:hover{background:#475569;}
.history-preview{font-size:12px;color:#f8fafc;opacity:0.8;}
.history-date{font-size:10px;color:#94a3b8;}

/* Code Block Styles - IMPROVED */
.code-block{
  background:#1e293b;
  border:1px solid #94a3b8;
  border-radius:8px;
  margin:10px 0;
  overflow:hidden;
  max-width:100%;
}
.code-header{
  background:#334155;
  padding:8px 12px;
  display:flex;
  justify-content:space-between;
  align-items:center;
  border-bottom:1px solid #94a3b8;
}
.code-title{
  font-size:14px;
  color:#94a3b8;
  font-weight:bold;
}
.code-actions{
  display:flex;
  gap:8px;
}
.code-btn{
  background:#475569;
  color:#f8fafc;
  border:none;
  border-radius:4px;
  padding:4px 8px;
  cursor:pointer;
  font-size:12px;
  transition:0.3s;
}
.code-btn:hover{
  background:#64748b;
}
.code-content{
  font-family:'Courier New', monospace;
  font-size:14px;
  color:#f8fafc;
  padding:12px;
  /* PERBAIKAN: Tambahkan scroll horizontal untuk kode panjang */
  overflow-x:auto;
  white-space:pre;
  max-height:400px;
  overflow-y:auto;
}
.code-output{
  background:#0f172a;
  border-top:1px solid #94a3b8;
  padding:12px;
  font-family:'Courier New', monospace;
  font-size:14px;
  color:#f8fafc;
  max-height:200px;
  overflow-y:auto;
  display:none;
}

/* User Message Box */
.user-bubble{background:#374151;border:1px solid #4b5563;color:#f8fafc;}

/* Image in chat styles */
.chat-image{max-width:100%;max-height:300px;border-radius:8px;border:1px solid #94a3b8;margin:5px 0;}

/* Media query untuk perangkat mobile */
@media (max-width: 768px) {
  .chat-box {padding-bottom:140px;}
  .input-area {padding-bottom:max(10px, env(safe-area-inset-bottom));}
  .msg {max-width:90%;}
  .stats-grid{grid-template-columns:1fr;}
  .modal-content{width:95%;margin:10px;}
}

/* Efek hati untuk jawaban spesial */
.heart-effect{color:#94a3b8;animation:heartbeat 1.5s ease infinite;}
@keyframes heartbeat{0%,100%{transform:scale(1);}50%{transform:scale(1.1);}}